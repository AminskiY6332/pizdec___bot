# Fail2Ban конфигурация для защиты Axidi Bot
# Разместить в /etc/fail2ban/filter.d/axidi.conf

[Definition]
# Паттерны для обнаружения подозрительной активности

# Множественные неудачные запросы к webhook
failregex = ^<HOST> .* "POST /webhook HTTP/.*" (400|401|403|404|429|500) .*$
            ^<HOST> .* "GET /webhook HTTP/.*" (405|404) .*$
            ^<HOST> .* ".*" (400|401|403|404|429|500) .* ".*axidi.*"$

# Подозрительные User-Agent
            ^<HOST> .* ".*" \d+ \d+ ".*" "(bot|scanner|crawler|wget|curl)" .*$

# Слишком много запросов от одного IP
            ^<HOST> .* ".*" \d+ \d+ ".*" ".*" \d+\.\d+ ms$

ignoreregex =

[Init]
# Максимальное количество строк для анализа
maxlines = 10

# Файлы логов для мониторинга pixelpieai.ru
logpath = /var/log/nginx/pixelpie_access.log
datepattern = %%Y-%%m-%%d %%H:%%M:%%S
